<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Push-Up Tracker</title>

  <!-- Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- ‚úÖ MediaPipe -->
 <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.min.js"></script>

  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #FFFFFF;
      color: #2F5C6D;
      font-family: 'Montserrat', sans-serif;
      line-height: 1.6;
    }

    /* Header Styles */
    header {
      background-color: #FFFFFF;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 15px rgba(47, 92, 109, 0.1);
      border-bottom: 3px solid #6CB817;
    }

    .logo {
      color: #2F5C6D;
      font-size: 1.5rem;
      font-weight: bold;
    }

    .logo span {
      color: #6CB817;
    }

    nav {
      display: flex;
      gap: 2rem;
    }

    nav a {
      color: #2F5C6D;
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s;
      padding: 0.5rem 1rem;
      border-radius: 5px;
    }

    nav a:hover {
      color: #6CB817;
      background: rgba(108, 184, 23, 0.1);
    }

    /* Main Content */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .main-title {
      color: #2F5C6D;
      text-align: center;
      margin-bottom: 2rem;
      font-size: 2.5rem;
    }

    .main-title span {
      color: #6CB817;
    }

    .content-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      align-items: start;
    }

    @media (max-width: 768px) {
      .content-wrapper {
        grid-template-columns: 1fr;
      }
    }

    /* Video Section */
    .video-section {
      text-align: center;
    }

    video {
      border: 4px solid #6CB817;
      border-radius: 15px;
      width: 100%;
      max-width: 600px;
      transform: scaleX(-1);
      box-shadow: 0 4px 20px rgba(47, 92, 109, 0.15);
    }

    .status {
      margin: 1rem 0;
      font-weight: 600;
      color: #6CB817;
      font-size: 1.1rem;
      background: rgba(108, 184, 23, 0.1);
      padding: 0.8rem;
      border-radius: 8px;
      border-left: 4px solid #6CB817;
    }

    /* Instructions */
    .instructions {
      background: #f8f9fa;
      border: 2px solid #6CB817;
      border-radius: 15px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 15px rgba(47, 92, 109, 0.1);
    }

    .instructions h3 {
      color: #2F5C6D;
      margin-bottom: 1rem;
      font-size: 1.3rem;
    }

    .instructions-list {
      list-style: none;
    }

    .instructions-list li {
      margin-bottom: 0.8rem;
      padding-left: 1.5rem;
      position: relative;
      color: #2F5C6D;
    }

    .instructions-list li:before {
      content: "‚úì";
      color: #6CB817;
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    /* Stats Section */
    .stats-section {
      background: #f8f9fa;
      border: 2px solid #6CB817;
      border-radius: 15px;
      padding: 2rem;
      text-align: center;
      box-shadow: 0 4px 15px rgba(47, 92, 109, 0.1);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-box {
      background: #FFFFFF;
      padding: 1.5rem;
      border-radius: 10px;
      border: 2px solid #2F5C6D;
      box-shadow: 0 2px 10px rgba(47, 92, 109, 0.1);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: bold;
      color: #6CB817;
      display: block;
    }

    .stat-label {
      font-size: 0.9rem;
      color: #2F5C6D;
      margin-top: 0.5rem;
      font-weight: 600;
    }

    /* Buttons */
    .buttons-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-top: 1rem;
    }

    button {
      background: #6CB817;
      color: #FFFFFF;
      border: none;
      padding: 12px 24px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-family: 'Montserrat', sans-serif;
      transition: all 0.3s ease;
      font-size: 1rem;
      box-shadow: 0 2px 8px rgba(108, 184, 23, 0.3);
    }

    button:hover {
      background: #5aa314;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(108, 184, 23, 0.4);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      background: #cccccc;
      color: #666666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    #reset {
      background: #2F5C6D;
      color: #FFFFFF;
      grid-column: span 2;
    }

    #reset:hover {
      background: #264a5a;
    }

    /* Tips */
    .tips {
      background: #f8f9fa;
      border: 2px solid #6CB817;
      border-radius: 15px;
      padding: 1.5rem;
      margin-top: 2rem;
      box-shadow: 0 4px 15px rgba(47, 92, 109, 0.1);
    }

    .tips h3 {
      color: #2F5C6D;
      margin-bottom: 1rem;
    }

    .tip-item {
      background: #FFFFFF;
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid #2F5C6D;
      box-shadow: 0 2px 8px rgba(47, 92, 109, 0.1);
    }

    .tip-item:last-child {
      margin-bottom: 0;
    }

    .tip-item strong {
      color: #6CB817;
    }

    /* Achievement Badge */
    .achievement {
      background: linear-gradient(135deg, #6CB817, #2F5C6D);
      color: white;
      padding: 1rem;
      border-radius: 10px;
      margin-top: 1rem;
      text-align: center;
      display: none;
    }

    .achievement.show {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    /* Mobile Adaptation */
@media (max-width: 768px) {
    /* Header mobile styles */
    header {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
        position: relative;
    }

    nav {
        gap: 0.5rem;
        flex-wrap: wrap;
        justify-content: center;
    }

    nav a {
        font-size: 0.8rem;
        padding: 0.4rem 0.8rem;
    }

    .logo {
        font-size: 1.3rem;
    }

    /* Hero section mobile */
    .hero {
        flex-direction: column;
        text-align: center;
        padding: 1rem;
        margin-top: 120px;
        min-height: auto;
    }

    .hero-content {
        max-width: 100%;
    }

    .hero h1 {
        font-size: 2rem;
        margin-bottom: 1rem;
    }

    .hero p {
        font-size: 1rem;
        margin-bottom: 2rem;
    }

    .hero-image {
        position: relative;
        width: 100%;
        max-width: 100%;
        transform: none;
        margin-top: 2rem;
    }

    .hero::before {
        background: linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.8) 100%);
    }

    /* Features grid mobile */
    .features-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .feature-card {
        padding: 1.5rem 1rem;
    }

    /* How it works mobile */
    .steps {
        flex-direction: column;
        gap: 1rem;
    }

    .step {
        padding: 1rem;
    }

    /* Push-Up page specific mobile styles */
    .container {
        padding: 1rem;
    }

    .main-title {
        font-size: 2rem;
        margin-bottom: 1.5rem;
    }

    .content-wrapper {
        gap: 1.5rem;
    }

    .stats-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .stat-box {
        padding: 1rem;
    }

    .stat-number {
        font-size: 2rem;
    }

    .buttons-grid {
        grid-template-columns: 1fr;
        gap: 0.8rem;
    }

    #reset {
        grid-column: span 1;
    }

    video {
        max-width: 100%;
    }

    .instructions {
        padding: 1.5rem 1rem;
        margin-bottom: 1.5rem;
    }

    .tips {
        padding: 1rem;
        margin-top: 1.5rem;
    }

    .status {
        font-size: 1rem;
        padding: 0.6rem;
    }

    /* Footer mobile */
    .footer-nav {
        flex-direction: column;
        gap: 1rem;
    }
}

/* Small mobile devices */
@media (max-width: 480px) {
    .hero h1 {
        font-size: 1.7rem;
    }

    .hero p {
        font-size: 0.9rem;
    }

    .cta-button {
        padding: 0.8rem 2rem;
        font-size: 1rem;
    }

    .main-title {
        font-size: 1.7rem;
    }

    nav a {
        font-size: 0.75rem;
        padding: 0.3rem 0.6rem;
    }

    .feature-card h3 {
        font-size: 1.3rem;
    }

    .how-it-works h2 {
        font-size: 2rem;
    }
}

/* Very small devices */
@media (max-width: 360px) {
    .hero h1 {
        font-size: 1.5rem;
    }

    .hero p {
        font-size: 0.85rem;
    }

    nav {
        gap: 0.3rem;
    }

    nav a {
        font-size: 0.7rem;
        padding: 0.3rem 0.5rem;
    }

    .stat-number {
        font-size: 1.8rem;
    }
}

/* Tablet adjustments */
@media (min-width: 769px) and (max-width: 1024px) {
    .hero h1 {
        font-size: 2.8rem;
    }

    .hero p {
        font-size: 1.1rem;
    }

    .hero-image {
        width: 45%;
    }

    .container {
        padding: 1.5rem;
    }
}
  </style>
</head>
<body>
  <header>
    <div class="logo" onclick="window.location.href=(`/index.html`)" >Health & <span>Game</span></div>
    <nav>
      <a href="/Push-Up.html">PUSH-UP</a>
      <a href="/Psixo.html">TEST</a>
      <a href="/Support.html">SUPPORT</a>
      <a href="/Profile.html">PROFILE</a>
      <a href="/DialogwithAI.html">DIALOGUE WITH AI</a>
    </nav>
  </header>

  <div class="container">
    <h1 class="main-title">Push-Up <span>Tracker</span></h1>

    <div class="content-wrapper">
      <div class="video-section">
        <video id="video" autoplay playsinline muted></video>
        <div class="status" id="status">Status: Click "Start Camera" to begin</div>
        
        <div class="instructions">
          <h3>üìã Camera Setup Guide</h3>
          <ul class="instructions-list">
            <li>Place camera to your side</li>
            <li>Make sure your whole body is visible from shoulders to hips</li>
            <li>Camera should be at chest level</li>
            <li>Ensure good lighting without harsh shadows</li>
          </ul>
        </div>
      </div>

      <div class="stats-section">
        <div class="stats-grid">
          <div class="stat-box">
            <span class="stat-number" id="count">0</span>
            <span class="stat-label">Push-Ups Completed</span>
          </div>
          <div class="stat-box">
            <span class="stat-number" id="minutes">0</span>
            <span class="stat-label">Game Minutes Earned</span>
          </div>
        </div>

        <div class="buttons-grid">
          <button id="start">Start Camera</button>
          <button id="stop" disabled>Stop Camera</button>
          <button id="reset">Reset Counter</button>
        </div>

        <div class="tips">
          <h3>üí° Pro Tips</h3>
          <div class="tip-item">
            <strong>Proper Form:</strong> Keep your body straight and lower until elbows are at 90¬∞
          </div>
          <div class="tip-item">
            <strong>Consistent Pace:</strong> Maintain steady rhythm for accurate counting
          </div>
          <div class="tip-item">
            <strong>Full Range:</strong> Complete each rep fully for best results
          </div>
        </div>

        <div class="achievement" id="achievement">
          üéâ Amazing work! Keep going! üéâ
        </div>
      </div>
    </div>
  </div>

  <script>
       if (!('WebAssembly' in window)) {
        alert('WebAssembly is not supported in your browser. Please update your browser.');
    }

    // –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    let pushups = parseInt(localStorage.getItem("pushups")) || 0;
    let minutes = parseInt(localStorage.getItem("minutes")) || 0;
    document.getElementById("count").textContent = pushups;
    document.getElementById("minutes").textContent = minutes;

    // –ö–∞–º–µ—Ä–∞ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    let camera = null;
    let pose = null;
    let isCameraActive = false;

    // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    function saveData() {
      localStorage.setItem("pushups", pushups);
      localStorage.setItem("minutes", minutes);
    }

    // –†–∞—Å—á–µ—Ç —É–≥–ª–∞ –º–µ–∂–¥—É —Ç—Ä–µ–º—è —Ç–æ—á–∫–∞–º–∏
    function getAngle(a, b, c) {
      const ab = { x: a.x - b.x, y: a.y - b.y };
      const cb = { x: c.x - b.x, y: c.y - b.y };
      const dot = ab.x * cb.x + ab.y * cb.y;
      const magAB = Math.hypot(ab.x, ab.y);
      const magCB = Math.hypot(cb.x, cb.y);
      let cos = dot / (magAB * magCB);
      cos = Math.min(1, Math.max(-1, cos));
      return (Math.acos(cos) * 180) / Math.PI;
    }

    // –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å—á–µ—Ç—á–∏–∫–∞
    let goingDown = false;
    let lastPushupTime = 0;
    const PUSHUPA_DELAY = 800; // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –æ—Ç–∂–∏–º–∞–Ω–∏—è–º–∏ (–º—Å)

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–º–µ—Ä—ã
    function startCamera() {
      if (isCameraActive) return;
      
      const video = document.getElementById("video");
      const status = document.getElementById("status");
      
      status.textContent = "Status: Starting camera...";
      
      try {
        pose = new Pose({
          locateFile: (file) => {
            return `https://cdn.jsdelivr.net/npm/@mediapipe/pose/${file}`;
          }
        });

        pose.setOptions({
          modelComplexity: 1,
          smoothLandmarks: true,
          enableSegmentation: false,
          minDetectionConfidence: 0.5,
          minTrackingConfidence: 0.5,
        });

        pose.onResults((results) => {
          if (!results.poseLandmarks) {
            status.textContent = "Status: Person not detected - please stand in front of camera";
            return;
          }
          
          status.textContent = "Status: Tracking...";
          
          const ls = results.poseLandmarks[11]; // –õ–µ–≤–æ–µ –ø–ª–µ—á–æ
          const le = results.poseLandmarks[13]; // –õ–µ–≤—ã–π –ª–æ–∫–æ—Ç—å
          const lw = results.poseLandmarks[15]; // –õ–µ–≤–æ–µ –∑–∞–ø—è—Å—Ç—å–µ
          
          const rs = results.poseLandmarks[12]; // –ü—Ä–∞–≤–æ–µ –ø–ª–µ—á–æ
          const re = results.poseLandmarks[14]; // –ü—Ä–∞–≤—ã–π –ª–æ–∫–æ—Ç—å
          const rw = results.poseLandmarks[16]; // –ü—Ä–∞–≤–æ–µ –∑–∞–ø—è—Å—Ç—å–µ

          // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–∏–π —É–≥–æ–ª –¥–≤—É—Ö –ª–æ–∫—Ç–µ–π –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
          const leftAngle = getAngle(ls, le, lw);
          const rightAngle = getAngle(rs, re, rw);
          const angle = (leftAngle + rightAngle) / 2;

          const currentTime = Date.now();
          
          // –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–¥—Å—á–µ—Ç–∞ —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
          if (angle < 70 && !goingDown && (currentTime - lastPushupTime) > PUSHUPA_DELAY) {
            goingDown = true;
            status.textContent = "Status: Going down...";
          } else if (angle > 150 && goingDown && (currentTime - lastPushupTime) > PUSHUPA_DELAY) {
            goingDown = false;
            pushups++;
            minutes++;
            lastPushupTime = currentTime;
            saveData();
            document.getElementById("count").textContent = pushups;
            document.getElementById("minutes").textContent = minutes;
            status.textContent = "Status: Push-up counted!";

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –¥–ª—è –≤–µ—Ö
            if (pushups % 10 === 0) {
              const achievement = document.getElementById('achievement');
              achievement.textContent = `üéâ Amazing! ${pushups} push-ups completed! üéâ`;
              achievement.classList.add('show');
              setTimeout(() => {
                achievement.classList.remove('show');
              }, 3000);
            }

            if (pushups % 100 === 0) {
              alert(`üî• Incredible! You've completed ${pushups} push-ups! You've earned ${minutes} minutes of game time.`);
            }
          }
        });

        // –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–∞–º–µ—Ä—É
        camera = new Camera(video, {
          onFrame: async () => {
            if (isCameraActive) {
              await pose.send({ image: video });
            }
          },
          width: 640,
          height: 480,
        });

        camera.start()
          .then(() => {
            isCameraActive = true;
            document.getElementById("start").disabled = true;
            document.getElementById("stop").disabled = false;
            status.textContent = "Status: Camera active - start doing push-ups!";
          })
          .catch(error => {
            console.error("Camera error:", error);
            status.textContent = "Status: Camera access error - please check permissions";
          });
      } catch (error) {
        console.error("Pose initialization error:", error);
        status.textContent = "Status: Failed to initialize pose detection";
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–∞–º–µ—Ä—ã
    function stopCamera() {
      if (camera && isCameraActive) {
        camera.stop();
        isCameraActive = false;
        document.getElementById("start").disabled = false;
        document.getElementById("stop").disabled = true;
        document.getElementById("status").textContent = "Status: Camera stopped";
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
    document.getElementById("start").addEventListener("click", startCamera);
    document.getElementById("stop").addEventListener("click", stopCamera);
    
    document.getElementById("reset").addEventListener("click", () => {
      pushups = 0;
      minutes = 0;
      saveData();
      document.getElementById("count").textContent = 0;
      document.getElementById("minutes").textContent = 0;
    });
  </script>
</body>
</html>